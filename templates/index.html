{% extends 'base.html' %}
{% load static %}
{% load nix %}

{% block title %}{{ config.site_name|default:'OldSkool' }} - Home{% endblock %}

{% block content %}
<!-- Main Section-->
<section class="mt-0 overflow-hidden ">
    <!-- Page Content Goes Here -->

    <!-- / Top banner -->
    <section class="vh-75 vh-lg-60 container-fluid rounded overflow-hidden" data-aos="fade-in">
        <!-- Swiper Info -->
        <div class="swiper-container overflow-hidden rounded h-100 bg-light" data-swiper data-options='{
          "spaceBetween": 0,
          "slidesPerView": 1,
          "effect": "fade",
          "speed": 1000,
          "loop": true,
          "parallax": true,
          "observer": true,
          "observeParents": true,
          "lazy": {
            "loadPrevNext": true
            },
            "autoplay": {
              "delay": 5000,
              "disableOnInteraction": false
          },
          "pagination": {
            "el": ".swiper-pagination",
            "clickable": true
            }
          }'>
          <div class="swiper-wrapper">

            <!-- Slide-->
            <div class="swiper-slide position-relative h-100 w-100">
              <div class="w-100 h-100 overflow-hidden position-absolute z-index-1 top-0 start-0 end-0 bottom-0">
                <div class="w-100 h-100 bg-img-cover bg-pos-center-center overflow-hidden" data-swiper-parallax="-100"
                  style=" will-change: transform; background-image: url({% static 'images/banners/banner-1.jpg' %})">
                </div>
              </div>
              <div
                class="container position-relative z-index-10 d-flex h-100 align-items-start flex-column justify-content-center">
                <p class="title-small text-white opacity-75 mb-0" data-swiper-parallax="-100">Everything You Need</p>
                <h2 class="display-3 tracking-wide fw-bold text-uppercase tracking-wide text-white" data-swiper-parallax="100">
                  <span class="text-outline-light">Summer</span> Essentials</h2>
                <div data-swiper-parallax-y="-25">
                  <a href="{% url 'product:new_arrivals' %}" class="btn btn-psuedo text-white" role="button">Shop New Arrivals</a>
                </div>
              </div>
            </div>
            <!-- /Slide-->

            <!-- Slide-->
            <div class="swiper-slide position-relative h-100 w-100">
              <div class="w-100 h-100 overflow-hidden position-absolute z-index-1 top-0 start-0 end-0 bottom-0">
                <div class="w-100 h-100 bg-img-cover bg-pos-center-center overflow-hidden" data-swiper-parallax="-100"
                  style=" will-change: transform; background-image: url({% static 'images/banners/banner-2.jpg' %})">
                </div>
              </div>
              <div
                class="container position-relative z-index-10 d-flex h-100 align-items-start flex-column justify-content-center">
                <p class="title-small text-white opacity-75 mb-0" data-swiper-parallax="-100">Spring Collection</p>
                <h2 class="display-3 tracking-wide fw-bold text-uppercase tracking-wide text-white" data-swiper-parallax="100">
                  Latest <span class="text-outline-light">Styles</span></h2>
                <div data-swiper-parallax-y="-25">
                  <a href="{% url 'product:product_list' %}" class="btn btn-psuedo text-white" role="button">Shop Latest Styles</a>
                </div>
              </div>
            </div>
            <!--/Slide-->

            <!-- Slide-->
            <div class="swiper-slide position-relative h-100 w-100">
              <div class="w-100 h-100 overflow-hidden position-absolute z-index-1 top-0 start-0 end-0 bottom-0">
                <div class="w-100 h-100 bg-img-cover bg-pos-center-center overflow-hidden" data-swiper-parallax="-100"
                  style=" will-change: transform; background-image: url({% static 'images/banners/banner-4.jpg' %})">
                </div>
              </div>
              <div
                class="container position-relative z-index-10 d-flex h-100 align-items-start flex-column justify-content-center">
                <p class="title-small text-white opacity-75 mb-0" data-swiper-parallax="-100">Exclusive Deals</p>
                <h2 class="display-3 tracking-wide fw-bold text-uppercase tracking-wide text-white" data-swiper-parallax="100">
                  Sale <span class="text-outline-light">Up to 50%</span></h2>
                <div data-swiper-parallax-y="-25">
                  <a href="{% url 'product:on_sale' %}" class="btn btn-psuedo text-white" role="button">Shop Sale Items</a>
                </div>
              </div>
            </div>
            <!--/Slide-->

          </div>

          <div class="swiper-pagination swiper-pagination-bullet-light"></div>

        </div>
        <!-- / Swiper Info-->
    </section>
    <!--/ Top Banner-->

    <div class="container-fluid">

        <!-- Featured Products -->
        {% if featured_products %}
        <div class="my-7 my-lg-10">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fs-4 fw-bolder m-0">Featured Products</h3>
                <a href="{% url 'product:product_list' %}" class="btn btn-link p-0 fw-bolder">View All</a>
            </div>

            <div class="row g-4">
                {% for product in featured_products %}
                <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                    {% product_card product %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        <!-- / Featured Products -->

        <!-- Featured Brands-->
        <div class="pt-5 pb-5 bg-light" data-aos="fade-in">
            <div class="container-fluid">
                <section class="overflow-hidden">
                    <div class="marquee-section-inner">
                        <div class="marquee-section animation-marquee-50">
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-1.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-2.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-3.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-4.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-5.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-6.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-7.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-8.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                            <div class="mx-5 f-w-24">
                                <a class="d-block" href="{% url 'product:product_list' %}">
                                    <picture>
                                        <img class="img-fluid d-table mx-auto" src="{% static 'images/logos/logo-9.svg' %}" alt="">
                                    </picture>
                                </a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        <!--/ Featured Brands-->

        <!-- New Arrivals -->
        {% if new_arrivals %}
        <div class="my-7 my-lg-10">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fs-4 fw-bolder m-0">New Arrivals</h3>
                <a href="{% url 'product:new_arrivals' %}" class="btn btn-link p-0 fw-bolder">View All</a>
            </div>

            <div class="row g-4">
                {% for product in new_arrivals %}
                <div class="col-6 col-md-4 col-lg-3">
                    {% product_card product %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        <!-- / New Arrivals -->

        <!-- On Sale Products -->
        {% if on_sale_products %}
        <div class="pt-7 mb-5 mb-lg-10">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fs-4 fw-bolder m-0 text-danger">Flash Sale</h3>
                <a href="{% url 'product:on_sale' %}" class="btn btn-link p-0 fw-bolder text-danger">View All Sale Items</a>
            </div>

            <div class="row g-4">
                <div class="col-12 col-xl-6 position-relative" data-aos="fade-right">
                    <picture class="position-relative z-index-10">
                        <img class="w-100 rounded" src="{% static 'images/banners/banner-sale.jpg' %}" alt="Flash Sale">
                    </picture>
                    <div class="position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center z-index-20">
                        <div class="py-6 px-5 px-lg-10 text-center w-100">
                            <h2 class="display-1 mb-3 fw-bold text-white"><span class="text-outline-light">Flash</span> Sale</h2>
                            <p class="fs-5 fw-light text-white d-none d-md-block">Grab yourself a bargain from the world's leading streetwear brands.</p>
                            <a href="{% url 'product:on_sale' %}" class="btn btn-psuedo text-white" role="button">Shop All Sale Items</a>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-xl-6" data-aos="fade-left">
                    <div class="row g-4">
                        {% for product in on_sale_products %}
                        <div class="col-6 col-md-6">
                            {% product_card product %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        <!-- / On Sale Products -->

    </div>

    <!-- /Page Content -->
</section>
<!-- / Main Section-->
{% endblock content %}

{% block extra_js %}
<script>
    // Wishlist toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.wishlist-toggle').forEach(function(btn) {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const productId = this.dataset.productId;

                fetch('{% url "toggle_wishlist" %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: 'product_id=' + productId
                })
                .then(response => response.json())
                .then(data => {
                    const icon = this.querySelector('i');
                    if (data.added) {
                        icon.classList.remove('ri-heart-line');
                        icon.classList.add('ri-heart-fill', 'text-danger');
                    } else {
                        icon.classList.remove('ri-heart-fill', 'text-danger');
                        icon.classList.add('ri-heart-line');
                    }

                    // Update wishlist count
                    const countEl = document.getElementById('wishlist-count');
                    if (countEl) {
                        countEl.textContent = data.wishlist_count;
                    }
                });
            });
        });
    });
</script>
{% endblock extra_js %}
